<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8"> <!-- 设置字符集为UTF-8 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- 视口设置，确保在移动设备上正确显示 -->
  <title>Zhao Guohui's blog</title> <!-- 页面标题 -->
  <link rel="icon" type="image/ico" href="./image/zhaoguohui_logo.webp"> <!-- 设置页面的图标 -->
  <style>
    #playPauseButton {
      position: absolute;
      /* 绝对定位 */
      left: 10px;
      /* 在最左边 */
      top: 150px;
      /* 可以根据需要调整垂直位置 */
      width: 30px;
      /* 设置图片按钮的宽度 */
      height: 30px;
      /* 设置图片按钮的高度 */
      cursor: pointer;
      /* 鼠标悬停时显示手型 */
    }

    .cywl {
      position: fixed;
      width: 100px;
      height: 100px;
      z-index: 9999;
      left: 50px;
      bottom: 50px;
      cursor: url(./Maxwell_Who-CatCursor/alternate.ico),
        default;
      display: flex;

      /* background-color: #5ee7df; */
    }

    .cywl img {
      width: 90px;
      height: 90px;
      pointer-events: none;
      user-select: none;
    }

    body {
      background-image: url('./image/background.avif');
      /* 设置背景图片 */
      background-size: cover;
      /* 背景图片覆盖整个背景区域 */
      background-position: center;
      /* 背景图片居中显示 */
      background-repeat: no-repeat;
      /* 背景图片不重复 */
      background-attachment: fixed;
      /* 背景图片固定 */
      opacity: 0;
      /* 初始状态为不可见 */
      transition: opacity 1s ease-in;
      /* 添加渐变效果 */
      position: relative;
      /* 相对定位 */
    }

    body.show {
      opacity: 1;
      /* 显示状态 */
    }

    img {
      transition: transform 0.5s ease-in-out;
      /* 图片渐变效果 */
      display: block;
      /* 将图片设置为块级元素 */
      margin: 10px auto;
      /* 添加上下边距并水平居中 */
      border-radius: 10px;
      /* 圆角 */
    }

    img:hover {
      transform: scale(1.03);
      /* 鼠标悬停时放大图片 */
    }

    details {
      transition: max-height 0.5s ease-in-out;
      /* 折叠内容的过渡效果 */
      overflow: hidden;
      /* 隐藏溢出的内容 */
    }

    div {
      border-radius: 10px;
      /* 圆角大小 */
    }

    details[open]>div {
      max-height: 1000px;
      /* 打开时设置最大高度 */
      transition: max-height 0.5s ease-in-out;
      /* 过渡效果 */
    }

    details>div {
      max-height: 0;
      /* 关闭时设置最大高度为0 */
      overflow: hidden;
      /* 隐藏内容 */
    }

    h1,
    h2 {
      transition: color 0.3s ease;
      /* 标题颜色的渐变效果 */
    }

    h1:hover,
    h2:hover {
      color: darkred;
      /* 鼠标悬停时标题颜色变化 */
    }

    .header {
      background: rgba(0, 0, 0, 0.7);
      /* 背景颜色 */
      display: flex;
      /* 使用flex布局 */
      justify-content: center;
      /* 水平居中 */
      align-items: center;
      /* 垂直居中 */
      height: 200px;
      /* 固定高度 */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6);
      /* 调整阴影的大小、模糊度和颜色 */
      border-radius: 10px;
      /* 圆角 */
    }

    .logo {
      width: 200px;
      /* 设置logo宽度 */
      height: 200px;
      /* 设置logo高度 */
    }

    .flex-container {
      display: flex;
      /* 使用flex布局 */
      flex-direction: column;
      /* 布局方向为列 */
      flex-wrap: wrap;
      /* 允许子项在必要时换行 */
      padding: 0px;
      /* 容器内边距 */
      gap: 7px;
      /* 子项之间的间隔 */
      margin: 20px;
      /* 外边距 */
      align-items: center;
      /* 垂直居中 */
    }

    .flex-item {
      flex-direction: column;
      /* 布局方向为列 */
      flex: 1;
      /* 允许格子项伸缩以填充可用空间 */
      width: 80%;
      /* 格子项的最小宽度 */
      height: 100px;
      /* 格子项的高度 */
      background-color: #f4f4f4;
      /* 背景颜色 */
      opacity: 0.9;
      /* 透明度 */
      display: flex;
      /* 使格子项内部也使用flex布局 */
      font-size: 18px;
      /* 字体大小 */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6);
      /* 调整阴影的大小、模糊度和颜色 */
    }

    .update {
      color: brown;
      /* 更新标题颜色 */
      opacity: 1;
      /* 透明度 */
      margin: 20px;
      /* 外边距 */
    }

    .footer {
      font-size: x-small;
      /* 字体大小 */
      color: white;
      /* 文字颜色 */
      background: rgba(0, 0, 0, 0.7);
      /* 背景颜色 */
      display: flex;
      /* 使用flex布局 */
      flex-direction: column;
      /* 布局方向为列 */
      align-items: center;
      /* 水平居中 */
      line-height: 5px;
      /* 行高 */
      padding: 20px;
      /* 内边距 */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6);
      /* 调整阴影的大小、模糊度和颜色 */
      border-radius: 10px;
      /* 圆角 */
    }

    .footer-logo {
      font-size: large;
      /* 字体大小 */
      color: rgb(40, 155, 231);
      /* 文字颜色 */
    }

    .center-content {
      display: flex;
      /* 使用flex布局 */
      justify-content: center;
      /* 水平居中 */
      align-items: center;
      /* 垂直居中 */
      height: 100%;
      /* 高度占满父容器 */
    }

    .bottom-right {
      position: absolute;
      /* 绝对定位 */
      right: 0;
      /* 右对齐 */
      margin: 10px;
      /* 外边距 */
    }

    .history-summary {
      background-color: rgba(221, 221, 221, 0.5);
      /* 背景颜色 */
      padding: 10px;
      /* 内边距 */
    }

    .history-content {
      display: flex;
      /* 使用flex布局 */
      flex-direction: column;
      /* 布局方向为列 */
      background-color: rgba(238, 238, 238, 0.5);
      /* 背景颜色 */
      padding: 10px;
      /* 内边距 */
    }

    .accordion {
      background-color: rgba(206, 206, 206, 0.4);
      /* 背景颜色 */
      color: #000000;
      /* 文字颜色 */
      cursor: pointer;
      /* 鼠标指针变为指针，表示可点击 */
      padding: 18px;
      /* 内边距 */
      width: 100%;
      /* 宽度占满父容器 */
      text-align: left;
      /* 文字左对齐 */
      border: none;
      /* 无边框 */
      outline: none;
      /* 无轮廓 */
      transition: 0.4s;
      /* 过渡效果 */
      font-size: medium;
      /* 字体大小 */
      font-weight: bold;
      /* 字体加粗 */
      border-radius: 10px;
      /* 圆角 */
    }

    .active,
    .accordion:hover {
      background-color: rgba(163, 163, 163, 0.4);
      /* 点击和悬停时的背景颜色 */
    }

    .panel {
      padding: 0 18px;
      /* 内边距 */
      background-color: rgba(228, 228, 228, 0.4);
      /* 背景颜色 */
      max-height: 0;
      /* 默认隐藏 */
      overflow: hidden;
      /* 隐藏溢出的内容 */
      transition: max-height 0.3s ease-out;
      /* 过渡效果 */
      display: flex;
      /* 使用flex布局 */
      flex-direction: column;
      /* 布局方向为列 */
    }

    .accordion:after {
      content: '\002B';
      /* Unicode 字符 + 号 */
      color: #777;
      /* 颜色 */
      font-weight: bold;
      /* 字体加粗 */
      float: right;
      /* 右对齐 */
      margin-left: 2px;
      /* 左边距 */
      font-size: large;
      /* 字体大小 */
    }

    .active:after {
      content: "\2212";
      /* Unicode 字符 - 号 */
    }
  </style>
</head>

<body class="show">
  <!--宠物开始-->
  <div id="pet" class="cywl">
    <img id="pet-img" src="./max/stand1.avif">
  </div>
  <!--宠物结束-->
  <header class="header"> <!-- 页眉区域，包含logo -->
    <img id="playPauseButton" src="./image/pause-icon.avif" alt="播放/暂停">
    <audio id="backgroundMusic" src="./video/bgm.mp3" type="audio/mpeg"></audio>
    <a href="https://zhaoguohui09820.github.io/index/"><img class="logo" src="./image/zhaoguohui_logo1.webp"
        alt="zhaoguohui_logo_300×300" width="200px" height="200px"></a>
  </header>

  <main class="flex-container"> <!-- 主要内容区域 -->
    <div class="flex-item" style="display: flex;flex-direction: row;"> <!-- 格子项 -->
      <a href="./desktop_oclock.html"><img src="./image/desktop_oclock.webp" alt="desktop_oclock" width="75" height="75"
          style="float: left;"></a>
    </div>
    <div class="flex-item"> <!-- 格子项 -->
      <button class="accordion">2024年7月29日</button> <!-- 手风琴按钮 -->
      <div class="panel"> <!-- 手风琴面板 -->
        <p>我的世界加入赵国辉的服务器教程</p>
        <p>视频教程：<a
            href="https://6qffx1-my.sharepoint.com/:v:/g/personal/zhao_6qffx1_onmicrosoft_com/ERCrcMK1qxNJvYRSp30FmlMBqW_I1jXmz--Pj4TUi8kGNw?e=qRYMbx">点击观看</a>
        </p>
        <p>压缩包下载（哪个能下载就用哪个，这几个链接都一样，只是提供了更多的下载渠道）：</p>
        <p>OneDrive：<a
            href="https://6qffx1-my.sharepoint.com/:u:/g/personal/zhao_6qffx1_onmicrosoft_com/ES_N0ngNlGNKvju0vwJexHYBNsAk7yZcjfSZ2Ad2fv06IA?e=EBzyen">点击下载</a>
        </p>
        <p>天翼云盘：<a href="https://cloud.189.cn/web/share?code=aqyANbreiuqm（访问码：tcc6）">点击下载</a></p>
        <p>坚果云：<a href="https://www.jianguoyun.com/p/DdUNbOwQzKblDBjNttAFIAA">点击下载</a></p>
        <p>123云盘：<a href="https://www.123pan.com/s/iDsSVv-CpKAv.html">点击下载</a></p>
        <p>百度网盘：<a href="https://pan.baidu.com/s/1lFWwO5DXyI-T9OSUX-5Szw?pwd=pkre 提取码: pkre">点击下载</a></p>
        <p>腾讯微云：<a href="https://share.weiyun.com/H6gm1FAJ">点击下载</a></p>
      </div>
      <button class="accordion">2024年7月19日</button> <!-- 手风琴按钮 -->
      <div class="panel"> <!-- 手风琴面板 -->
        <p>太抽象了吧，那么多人，体验就一个字“史”</p>
        <img src="./image/2024_7_19_01.avif" alt="2024_7_19_01" width="80%" height="auto">
        <img src="./image/2024_7_19_02.avif" alt="2024_7_19_02" width="80%" height="auto">
      </div>
      <button class="accordion">2024年7月18日</button> <!-- 手风琴按钮 -->
      <div class="panel"> <!-- 手风琴面板 -->
        <p>冯少杰的素描</p>
        <p>原图下载链接在末尾</p>
        <img src="./image/fengshaojiesumiao.avif" alt="fengshaojiesumiao" width="80%" height="auto">
        <p>OneDrive：<a
            href="https://6qffx1-my.sharepoint.com/:i:/g/personal/zhao_6qffx1_onmicrosoft_com/ET6gA2_ivPpFiUot3RbxXYsBA0tqLXYy-2tPAuiC8u-98Q?e=x0bbj7">点击下载</a>
        </p>
        <p>天翼云盘：<a href="https://cloud.189.cn/web/share?code=aAZ7BzAfiYrm（访问码：0jiy）">点击下载</a></p>
        <p>坚果云：<a href="https://www.jianguoyun.com/p/DSZJ9q4QzKblDBjiutAFIAA">点击下载</a></p>
        <p>123云盘：<a href="https://www.123pan.com/s/iDsSVv-rpKAv.html">点击下载</a></p>
        <p>百度网盘：<a href="https://pan.baidu.com/s/1C2WU4fKFrkrekiYX2-9h2A?pwd=8qy3">点击下载</a></p>
        <p>腾讯微云：<a href="https://share.weiyun.com/P3r0CgO3">点击下载</a></p>
      </div>
    </div>
  </main>

  <footer class="footer"> <!-- 页脚区域 -->
    <p class="footer-logo">致谢：冯少杰（第一位志愿者）</p>
    <p>站长的微信：Zhao_guohui09820</p>
    <p>站长的QQ：2592299180</p>
    <p>站长的电子邮箱：zhaolixiangguohui@outlook.com</p>
    <p><b>👇</b>我的头像</p>
    <img src="./image/蜡笔小新头像.avif" alt="xiaoxin" height="70px" width="70px">
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var audio = document.getElementById('backgroundMusic');
      var button = document.getElementById('playPauseButton');
      var isPlaying = false;

      button.addEventListener('click', function () {
        if (isPlaying) {
          audio.pause();
          button.src = './image/pause-icon.avif';
        } else {
          audio.play();
          button.src = './image/play-icon.avif';
        }
        isPlaying = !isPlaying;
      });
    });
    // 创建 pet 对象
    const pet = {
      x: 50,   // 宠物初始位置的横坐标 （左下角开始）
      y: 50,
      vx: 1,   // 水平方向上宠物前进的速度
      vy: 0   // // 垂直方向上宠物前进的速度
    };

    // -------------------------------------------------------------动作
    // 动作权重
    // 权重问题：将所有权重相加，（得到一个大范围，那么就让随机数落到这个范围内，而对应的权重，就是落到的对应位置中）
    var actions = {
      // 普通
      walkleft: 1,
      walkright: 1,

      fish: 1,
      sleep: 1,
      kiss: 1,

      stand: 1,


    };

    // 存储宠物行走动画帧的数组
    const LeftwalkFrames = []; // 左走
    const RightwalkFrames = []; // 右走

    const DragFrames = [];  // 拖拽

    const fishFrames = [];
    const kissFrames = [];
    const sleepFrames = [];

    const standFrames = [];

    const fallingFrames = [];


    // 初始化 定时器
    var ttt = null;
    var dragTime = null;

    var action = 'stand';


    //1、将对象中的动作按照权重转换为数组。可以使用 Object.keys 方法获取对象的键，
    //2、再使用 Array.map 方法将每个键转换为对象 {name: key, weight: actions[key]}。
    //3、最后使用 Array.reduce 方法将多个对象合成一个数组
    var actionList = Object.keys(actions).map(function (key) {
      return {
        name: key,
        weight: actions[key]
      };
    }).reduce(function (prev, curr) {
      return prev.concat(curr);
    }, []);


    // 根据权重随机选择动作 
    // 权重问题：将所有权重相加，（得到一个大范围，那么就让随机数落到这个范围内，而对应的权重，就是落到的对应位置中）

    function randomAction() {
      var totalWeight = actionList.reduce(function (prev, curr) {
        return prev + curr.weight;
      }, 0);
      // console.log(totalWeight);

      var randomNum = Math.random() * totalWeight;

      for (var i = 0; i < actionList.length; i++) {
        if (randomNum <= actionList[i].weight) {
          return actionList[i].name;
        }
        randomNum -= actionList[i].weight;
      }
    }
    // -------------------------------------------------------------动作




    const img111 = new Image();
    img111.src = `./max/falling1.avif`;
    fallingFrames.push(img111);

    // 创建动画序列  
    for (let i = 1; i < 13; i++) {
      // 将行走动画帧添加到 walkFrames 数组中

      const img = new Image();
      img.src = `./max/walkright${i}.avif`;
      RightwalkFrames.push(img);

      const img2 = new Image();
      img2.src = `./max/walkleft${i}.avif`;
      LeftwalkFrames.push(img2);

      // 其他

      const img3 = new Image();
      img3.src = `./max/drag${i}.avif`;
      DragFrames.push(img3);

      const img4 = new Image();
      img4.src = `./max/fish${i}.avif`;
      fishFrames.push(img4);

      const img5 = new Image();
      img5.src = `./max/kiss${i}.avif`;
      kissFrames.push(img5);

      const img6 = new Image();
      img6.src = `./max/sleep${i}.avif`;
      sleepFrames.push(img6);

      const img7 = new Image();
      img7.src = `./max/stand${i}.avif`;
      standFrames.push(img7);

    }

    // 绘制宠物
    function drawPet(anyFrames = RightwalkFrames) {
      const frameIndex = Math.floor(Date.now() / 100) % anyFrames.length;  // 计算当前应该绘制的动画帧的索引
      const img = anyFrames[frameIndex]; // 获取当前应该绘制的动画帧

      document.querySelector('.cywl img').src = img.src;  // 更新宠物的显示图像
    }



    // 更新宠物位置
    function updatePet() {


      pet.x += pet.vx;   // 更新宠物在水平方向的位置
      // pet.y += pet.vy;

      // 超出屏幕左边
      if (pet.x < 0) {
        action = 'walkright'
      }
      // 超出屏幕右边
      if (pet.x + petDiv.clientWidth > window.innerWidth) {
        action = 'walkleft'
      }



      petDiv.style.left = pet.x + 'px';   // 更新宠物所在 div 元素的横坐标位置
      petDiv.style.bottom = pet.y + 'px';
    }



    // ----------------------------------------------------------------------处理用户交互

    // 定位
    const petDiv = document.querySelector('#pet');
    petDiv.style.left = pet.x + 'px';   // 更新宠物所在 div 元素的横坐标位置
    petDiv.style.bottom = pet.y + 'px';

    // 禁用图片点击
    const petImg = document.querySelector('#pet-img');
    petImg.style.pointerEvents = 'none';


    var isDragging = false;   // 标记是否正在拖拽中
    var diffX = 0;    // 鼠标指针与盒子左上角的偏移量
    var diffY = 0;


    let animationId = null;


    // 鼠标按下
    petDiv.addEventListener('mousedown', function (event) {

      action = '';

      clearInterval(petTimer); // 暂停宠物行动的定时器

      // 判断鼠标是否在 div 元素内按下，并记录下偏移量
      if (event.target === petDiv) {
        isDragging = true;
        diffX = event.clientX - petDiv.offsetLeft;
        diffY = event.clientY - petDiv.offsetTop;

        // 拖拽定时器
        dragTime = setInterval(function drag() {
          // 显示拖拽 图片
          drawPet(DragFrames);

          // 这里不能用这个，会导致开启多个loop
          // animationId = requestAnimationFrame(loop);  // 浏览器提供的 API，用于优化动画性能并在重绘之前在主线程上执行指定的函数

        }, 100);

      }
    });



    // 鼠标拖动
    document.addEventListener('mousemove', function (event) {
      // 如果正在拖拽中，则更新盒子位置
      if (isDragging === true) {



        pet.x = event.clientX - diffX
        pet.y = event.clientY - diffY

        petDiv.style.left = pet.x + 'px';
        petDiv.style.top = pet.y + 'px';
      }

    });

    // 鼠标抬起
    document.addEventListener('mouseup', function (event) {
      if (isDragging === true) {

        // 清除旧的定时器
        clearInterval(ttt);
        clearInterval(dragTime);

        // 停止拖拽
        isDragging = false;

        action = 'stand';

        ttt = setInterval(function name() {
          action = randomAction();
        }, 3000);


        // 超出屏幕 回到 指定位置 
        if (pet.y < 0 || pet.y + petDiv.clientHeight > window.innerHeight || pet.x + petDiv.clientWidth > window.innerWidth || pet.x < 0) {
          pet.x = 500;
          pet.y = 500;
          const petDiv = document.querySelector('#pet');
          petDiv.style.left = 500 + 'px';   // 更新宠物所在 div 元素的位置
          petDiv.style.top = 500 + 'px';
          // console.log(1111111)
        }


        // 显示下落 图片
        drawPet(fallingFrames);
        // animationId = requestAnimationFrame(loop);  // 浏览器提供的 API，用于优化动画性能并在重绘之前在主线程上执行指定的函数

        // loop();
      }

    });

    // 宠物行动的定时器，每 3 秒执行一次 doAction 函数
    var petTimer = setInterval(function name() {
      action = randomAction();
    }, 3000);




    // ----------------------------------------------------------------------
    // 主循环
    function loop() {


      console.log(action);
      if (action == 'walkleft') {
        // 执行 leftwalk 动作
        pet.vx = -0.5;
        updatePet();
        drawPet(LeftwalkFrames);

      }

      if (action == 'walkright') {
        pet.vx = 0.5;
        updatePet();
        drawPet(RightwalkFrames);

      }

      if (action == 'fish') {
        // updatePet();
        drawPet(fishFrames);

      }

      if (action == 'kiss') {
        // updatePet();
        drawPet(kissFrames);

      }

      if (action == 'sleep') {
        // updatePet();
        drawPet(sleepFrames);

      }

      if (action == 'stand') {
        // updatePet();
        drawPet(standFrames);

      }
      requestAnimationFrame(loop);  // 浏览器提供的 API，用于优化动画性能并在重绘之前在主线程上执行指定的函数
    }

    // 启动循环
    loop();
    var acc = document.getElementsByClassName("accordion"); // 获取所有手风琴按钮
    for (var i = 0; i < acc.length; i++) { // 遍历所有手风琴按钮
      acc[i].addEventListener("click", function () { // 为每个手风琴按钮添加点击事件监听器
        var currentButton = this; // 当前被点击的按钮
        var currentPanel = this.nextElementSibling; // 当前按钮后的面板

        currentButton.classList.toggle("active"); // 切换当前按钮的active类

        if (currentPanel && currentPanel.classList.contains('panel')) { // 如果当前按钮后的元素是.panel，则切换其maxHeight属性
          currentPanel.style.maxHeight = currentPanel.style.maxHeight ? null : currentPanel.scrollHeight + "px"; // 展开或收起面板
        }
      });
    }
  </script>
</body>

</html>